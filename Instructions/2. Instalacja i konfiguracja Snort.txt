1. Pierwszym krokiem będzie instalacja pakietów req i snort w odpowiedniej koljeności. Trzeba je najpierw pobrać z oficjalnej strony www.snort.org.
rpm -ihv daq-2.0.5-1.centos7.x86_64.rpm snort-2.9.7.3-1.centos7.x86_64.rpm 

2. Można sprawdzić pliki konfiguracyjne. 
rpm ­-ql snort|grep etc

3. Zarządzanie serwisem snortd :
service snortd start
service snortd stop
service snortd reload
service snortd status

4. Początkowo snort nie wystartuje poprawnie, trzeba go dokonfigurować. Przyczynę błędu można sprawdzić poprzez wykonianie :
service snortd status
grep snort.conf /var/log/messages
snort -c /etc/snort/snort.conf -T

5. Należy teraz zdefiniować zestaw reguł dla snorta. Można je pobrać z oficjalnej strony snorta.
tar -xf snortrules-snapshot-2973.tar.gz
cp rules/* /etc/snort/rules

mkdir /etc/snort/rules/preproc_rules
cp preproc_rules/* /etc/snort/rules/preproc_rules

mkdir /etc/snort/rules/so_rules
cp so_rules/* /etc/snort/rules/so_rules - tylko pliki .rules

cp etc/sid-msg.map /etc/snort

6. Należy także dokonać odpowiedniej konfiguracji w pliku snort.conf.
gedit /etc/snort/snort.conf

# dynamicdetection directory /usr/local/lib/snort_dynamicrules

var RULE_PATH /etc/snort/rules
var SO_RULE_PATH /etc/snort/rules/so_rules
var PREPROC_RULE_PATH /etc/snort/rules/preproc_rules

include $PREPROC_RULE_PATH/preprocessor.rules
include $PREPROC_RULE_PATH/decoder.rules
include $PREPROC_RULE_PATH/sensitive­data.rules

# Reputation preprocessor. For more information see README.reputation
# preprocessor reputation: \
#   memcap 500, \
#   priority whitelist, \
#   nested_ip inner, \
#   whitelist $WHITE_LIST_PATH/white_list.rules, \
#   blacklist $BLACK_LIST_PATH/black_list.rules 

7. Odpalenie Snorta jako sniffera.

wypisywanie jedynie na ekranie
snort -v

zapisywanie do pliku logow w wyznaczonym katalogu
snort -v -l katalog

zapisywanie do pliku logow w postaci binarnej (sybsze)
snort -v -l katalog -b

odczyt pliku binarnego i wypisanie na konsoli
snort -r snort.log.1438112254

określenie interfejsu do nasłuchu
snort -v -i enp0s3

określa zakończenie działania po odsłuchaniu odpowieniej ilości pakietów, w tym przypadku trzech
snort ­-n 3 -v

Rozszerzone wypisanie nagłówków pakietów ICMP:
snort ­-n 1 -­e -­v icmp

Wypisanie pakietów UDP DNS wraz z zawartością w postaci tekstowej:
snort -­n 2 -­dveC udp port 53

Odczyt z pliku z zamaskowaniem adresów IP:
snort ­-v -O ­-r snort.log.1197538673

Plik tworzony przez polecenie snort, ma taki sam format jak ten od tcpdump
tcpdump -vvv -r snort.log.1438112254

Zapis pakietów w trybie ascii:
snort -l . -K ascii -i enp0s3 -n 10
cat 10.0.2.15/TCP:59390-443




